"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/ontario-parks/resource-details/getResourceDetails";
exports.ids = ["pages/api/ontario-parks/resource-details/getResourceDetails"];
exports.modules = {

/***/ "(api)/./src/pages/api/ontario-parks/resource-details/getResourceDetails.ts":
/*!****************************************************************************!*\
  !*** ./src/pages/api/ontario-parks/resource-details/getResourceDetails.ts ***!
  \****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler),\n/* harmony export */   \"getResourceLocationDetails\": () => (/* binding */ getResourceLocationDetails)\n/* harmony export */ });\n// in-memory cache\nlet resourceCache = null;\nlet resourceCacheTimestamp = null;\n// cache time of 7 days\nconst CACHE_DURATION = 1000 * 60 * 60 * 168;\nasync function fetchResourceLocation() {\n    const now = Date.now();\n    // check if the cache is still valid\n    if (resourceCache && resourceCacheTimestamp && now - resourceCacheTimestamp < CACHE_DURATION) {\n        return resourceCache;\n    }\n    // if cache is not valid, fetch new data\n    try {\n        const url = `https://reservations.ontarioparks.ca/api/resourceLocation`;\n        const resp = await fetch(url);\n        if (!resp.ok) {\n            const errorDetails = await resp.text();\n            console.error(`Failed to fetch data: ${resp.status}, details: ${errorDetails}`);\n            throw new Error(`Failed to fetch data: ${resp.status}`);\n        }\n        const data = await resp.json();\n        // we create a new map to store only the fields we care about\n        const resourceMap = new Map();\n        data.forEach((entry)=>{\n            const localizedEntry = entry.localizedValues.find((val)=>val.cultureName === \"en-CA\");\n            resourceMap.set(entry.resourceLocationId, {\n                fullName: localizedEntry?.fullName,\n                description: localizedEntry?.description,\n                streetAddress: localizedEntry?.streetAddress,\n                website: localizedEntry?.website,\n                city: localizedEntry?.city,\n                region: entry.region,\n                regionCode: entry.regionCode,\n                country: entry.country,\n                phoneNumber: entry.phoneNumber\n            });\n        });\n        // update the cache\n        resourceCache = resourceMap;\n        resourceCacheTimestamp = now;\n        return resourceMap;\n    } catch (error) {\n        console.error(\"Error fetching resource location data:\", error);\n        throw new Error(\"Failed to fetch resource location data\");\n    }\n}\nasync function getResourceLocationDetails(resourceLocationId) {\n    try {\n        const resourceMap = await fetchResourceLocation();\n        return resourceMap.get(resourceLocationId) || null;\n    } catch (error) {\n        console.error(\"Error fetching resource location details:\", error);\n        return null;\n    }\n}\nasync function handler(req, res) {\n    const { resourceLocationId  } = req.query;\n    // validate and parse mapId\n    if (!resourceLocationId || Array.isArray(resourceLocationId)) {\n        return res.status(400).json({\n            error: \"Invalid or missing mapId parameter\"\n        });\n    }\n    const resourceLocationIdNumber = Number(resourceLocationId);\n    try {\n        console.log(\"the resource location id is: \", resourceLocationId);\n        const data = await getResourceLocationDetails(resourceLocationIdNumber);\n        if (!data) {\n            return res.status(404).json({\n                error: \"Resource location not found\"\n            });\n        }\n        return res.status(200).json(data);\n    } catch (error) {\n        console.error(\"Error in handler:\", error);\n        return res.status(500).json({\n            error: \"Failed to fetch resource location data\"\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9zcmMvcGFnZXMvYXBpL29udGFyaW8tcGFya3MvcmVzb3VyY2UtZGV0YWlscy9nZXRSZXNvdXJjZURldGFpbHMudHMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFJQSxrQkFBa0I7QUFDbEIsSUFBSUEsZ0JBQW1ELElBQUk7QUFDM0QsSUFBSUMseUJBQXdDLElBQUk7QUFFaEQsdUJBQXVCO0FBQ3ZCLE1BQU1DLGlCQUFpQixPQUFPLEtBQUssS0FBSztBQUV4QyxlQUFlQyx3QkFBNkQ7SUFDMUUsTUFBTUMsTUFBTUMsS0FBS0QsR0FBRztJQUVwQixvQ0FBb0M7SUFDcEMsSUFDRUosaUJBQ0FDLDBCQUNBRyxNQUFNSCx5QkFBeUJDLGdCQUMvQjtRQUNBLE9BQU9GO0lBQ1QsQ0FBQztJQUVELHdDQUF3QztJQUN4QyxJQUFJO1FBQ0YsTUFBTU0sTUFBTSxDQUFDLHlEQUF5RCxDQUFDO1FBQ3ZFLE1BQU1DLE9BQU8sTUFBTUMsTUFBTUY7UUFFekIsSUFBSSxDQUFDQyxLQUFLRSxFQUFFLEVBQUU7WUFDWixNQUFNQyxlQUFlLE1BQU1ILEtBQUtJLElBQUk7WUFDcENDLFFBQVFDLEtBQUssQ0FDWCxDQUFDLHNCQUFzQixFQUFFTixLQUFLTyxNQUFNLENBQUMsV0FBVyxFQUFFSixhQUFhLENBQUM7WUFFbEUsTUFBTSxJQUFJSyxNQUFNLENBQUMsc0JBQXNCLEVBQUVSLEtBQUtPLE1BQU0sQ0FBQyxDQUFDLEVBQUU7UUFDMUQsQ0FBQztRQUVELE1BQU1FLE9BQWlDLE1BQU1ULEtBQUtVLElBQUk7UUFFdEQsNkRBQTZEO1FBQzdELE1BQU1DLGNBQWMsSUFBSUM7UUFDeEJILEtBQUtJLE9BQU8sQ0FBQyxDQUFDQyxRQUFVO1lBQ3RCLE1BQU1DLGlCQUFpQkQsTUFBTUUsZUFBZSxDQUFDQyxJQUFJLENBQy9DLENBQUNDLE1BQVFBLElBQUlDLFdBQVcsS0FBSztZQUcvQlIsWUFBWVMsR0FBRyxDQUFDTixNQUFNTyxrQkFBa0IsRUFBRTtnQkFDeENDLFVBQVVQLGdCQUFnQk87Z0JBQzFCQyxhQUFhUixnQkFBZ0JRO2dCQUM3QkMsZUFBZVQsZ0JBQWdCUztnQkFDL0JDLFNBQVNWLGdCQUFnQlU7Z0JBQ3pCQyxNQUFNWCxnQkFBZ0JXO2dCQUN0QkMsUUFBUWIsTUFBTWEsTUFBTTtnQkFDcEJDLFlBQVlkLE1BQU1jLFVBQVU7Z0JBQzVCQyxTQUFTZixNQUFNZSxPQUFPO2dCQUN0QkMsYUFBYWhCLE1BQU1nQixXQUFXO1lBQ2hDO1FBQ0Y7UUFFQSxtQkFBbUI7UUFDbkJyQyxnQkFBZ0JrQjtRQUNoQmpCLHlCQUF5Qkc7UUFFekIsT0FBT2M7SUFDVCxFQUFFLE9BQU9MLE9BQU87UUFDZEQsUUFBUUMsS0FBSyxDQUFDLDBDQUEwQ0E7UUFDeEQsTUFBTSxJQUFJRSxNQUFNLDBDQUEwQztJQUM1RDtBQUNGO0FBRU8sZUFBZXVCLDJCQUNwQlYsa0JBQTBCLEVBQ0s7SUFDL0IsSUFBSTtRQUNGLE1BQU1WLGNBQWMsTUFBTWY7UUFDMUIsT0FBT2UsWUFBWXFCLEdBQUcsQ0FBQ1gsdUJBQXVCLElBQUk7SUFDcEQsRUFBRSxPQUFPZixPQUFPO1FBQ2RELFFBQVFDLEtBQUssQ0FBQyw2Q0FBNkNBO1FBQzNELE9BQU8sSUFBSTtJQUNiO0FBQ0YsQ0FBQztBQUVjLGVBQWUyQixRQUM1QkMsR0FBbUIsRUFDbkJDLEdBQW9CLEVBQ3BCO0lBQ0EsTUFBTSxFQUFFZCxtQkFBa0IsRUFBRSxHQUFHYSxJQUFJRSxLQUFLO0lBRXhDLDJCQUEyQjtJQUMzQixJQUFJLENBQUNmLHNCQUFzQmdCLE1BQU1DLE9BQU8sQ0FBQ2pCLHFCQUFxQjtRQUM1RCxPQUFPYyxJQUFJNUIsTUFBTSxDQUFDLEtBQUtHLElBQUksQ0FBQztZQUFFSixPQUFPO1FBQXFDO0lBQzVFLENBQUM7SUFFRCxNQUFNaUMsMkJBQTJCQyxPQUFPbkI7SUFFeEMsSUFBSTtRQUNGaEIsUUFBUW9DLEdBQUcsQ0FBQyxpQ0FBaUNwQjtRQUM3QyxNQUFNWixPQUFPLE1BQU1zQiwyQkFBMkJRO1FBQzlDLElBQUksQ0FBQzlCLE1BQU07WUFDVCxPQUFPMEIsSUFBSTVCLE1BQU0sQ0FBQyxLQUFLRyxJQUFJLENBQUM7Z0JBQUVKLE9BQU87WUFBOEI7UUFDckUsQ0FBQztRQUNELE9BQU82QixJQUFJNUIsTUFBTSxDQUFDLEtBQUtHLElBQUksQ0FBQ0Q7SUFDOUIsRUFBRSxPQUFPSCxPQUFPO1FBQ2RELFFBQVFDLEtBQUssQ0FBQyxxQkFBcUJBO1FBQ25DLE9BQU82QixJQUFJNUIsTUFBTSxDQUFDLEtBQUtHLElBQUksQ0FBQztZQUFFSixPQUFPO1FBQXlDO0lBQ2hGO0FBQ0YsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL2NhbXBmaW5kci8uL3NyYy9wYWdlcy9hcGkvb250YXJpby1wYXJrcy9yZXNvdXJjZS1kZXRhaWxzL2dldFJlc291cmNlRGV0YWlscy50cz9kMjAzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFJlc291cmNlRW50cnksIFJlc291cmNlSW5wdXQgfSBmcm9tIFwiQHBhY2thZ2VzL3R5cGVzXCI7XG5pbXBvcnQgeyBSZXNvdXJjZUxvY2F0aW9uUmVzcG9uc2UgfSBmcm9tIFwiLi90eXBlc1wiO1xuaW1wb3J0IHsgTmV4dEFwaVJlcXVlc3QsIE5leHRBcGlSZXNwb25zZSB9IGZyb20gXCJuZXh0XCI7XG5cbi8vIGluLW1lbW9yeSBjYWNoZVxubGV0IHJlc291cmNlQ2FjaGU6IE1hcDxudW1iZXIsIFJlc291cmNlRW50cnk+IHwgbnVsbCA9IG51bGw7XG5sZXQgcmVzb3VyY2VDYWNoZVRpbWVzdGFtcDogbnVtYmVyIHwgbnVsbCA9IG51bGw7XG5cbi8vIGNhY2hlIHRpbWUgb2YgNyBkYXlzXG5jb25zdCBDQUNIRV9EVVJBVElPTiA9IDEwMDAgKiA2MCAqIDYwICogMTY4O1xuXG5hc3luYyBmdW5jdGlvbiBmZXRjaFJlc291cmNlTG9jYXRpb24oKTogUHJvbWlzZTxNYXA8bnVtYmVyLCBSZXNvdXJjZUVudHJ5Pj4ge1xuICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuXG4gIC8vIGNoZWNrIGlmIHRoZSBjYWNoZSBpcyBzdGlsbCB2YWxpZFxuICBpZiAoXG4gICAgcmVzb3VyY2VDYWNoZSAmJlxuICAgIHJlc291cmNlQ2FjaGVUaW1lc3RhbXAgJiZcbiAgICBub3cgLSByZXNvdXJjZUNhY2hlVGltZXN0YW1wIDwgQ0FDSEVfRFVSQVRJT05cbiAgKSB7XG4gICAgcmV0dXJuIHJlc291cmNlQ2FjaGU7XG4gIH1cblxuICAvLyBpZiBjYWNoZSBpcyBub3QgdmFsaWQsIGZldGNoIG5ldyBkYXRhXG4gIHRyeSB7XG4gICAgY29uc3QgdXJsID0gYGh0dHBzOi8vcmVzZXJ2YXRpb25zLm9udGFyaW9wYXJrcy5jYS9hcGkvcmVzb3VyY2VMb2NhdGlvbmA7XG4gICAgY29uc3QgcmVzcCA9IGF3YWl0IGZldGNoKHVybCk7XG5cbiAgICBpZiAoIXJlc3Aub2spIHtcbiAgICAgIGNvbnN0IGVycm9yRGV0YWlscyA9IGF3YWl0IHJlc3AudGV4dCgpO1xuICAgICAgY29uc29sZS5lcnJvcihcbiAgICAgICAgYEZhaWxlZCB0byBmZXRjaCBkYXRhOiAke3Jlc3Auc3RhdHVzfSwgZGV0YWlsczogJHtlcnJvckRldGFpbHN9YFxuICAgICAgKTtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgRmFpbGVkIHRvIGZldGNoIGRhdGE6ICR7cmVzcC5zdGF0dXN9YCk7XG4gICAgfVxuXG4gICAgY29uc3QgZGF0YTogUmVzb3VyY2VMb2NhdGlvblJlc3BvbnNlID0gYXdhaXQgcmVzcC5qc29uKCk7XG5cbiAgICAvLyB3ZSBjcmVhdGUgYSBuZXcgbWFwIHRvIHN0b3JlIG9ubHkgdGhlIGZpZWxkcyB3ZSBjYXJlIGFib3V0XG4gICAgY29uc3QgcmVzb3VyY2VNYXAgPSBuZXcgTWFwPG51bWJlciwgUmVzb3VyY2VFbnRyeT4oKTtcbiAgICBkYXRhLmZvckVhY2goKGVudHJ5KSA9PiB7XG4gICAgICBjb25zdCBsb2NhbGl6ZWRFbnRyeSA9IGVudHJ5LmxvY2FsaXplZFZhbHVlcy5maW5kKFxuICAgICAgICAodmFsKSA9PiB2YWwuY3VsdHVyZU5hbWUgPT09IFwiZW4tQ0FcIlxuICAgICAgKTtcblxuICAgICAgcmVzb3VyY2VNYXAuc2V0KGVudHJ5LnJlc291cmNlTG9jYXRpb25JZCwge1xuICAgICAgICBmdWxsTmFtZTogbG9jYWxpemVkRW50cnk/LmZ1bGxOYW1lLFxuICAgICAgICBkZXNjcmlwdGlvbjogbG9jYWxpemVkRW50cnk/LmRlc2NyaXB0aW9uLFxuICAgICAgICBzdHJlZXRBZGRyZXNzOiBsb2NhbGl6ZWRFbnRyeT8uc3RyZWV0QWRkcmVzcyxcbiAgICAgICAgd2Vic2l0ZTogbG9jYWxpemVkRW50cnk/LndlYnNpdGUsXG4gICAgICAgIGNpdHk6IGxvY2FsaXplZEVudHJ5Py5jaXR5LFxuICAgICAgICByZWdpb246IGVudHJ5LnJlZ2lvbixcbiAgICAgICAgcmVnaW9uQ29kZTogZW50cnkucmVnaW9uQ29kZSxcbiAgICAgICAgY291bnRyeTogZW50cnkuY291bnRyeSxcbiAgICAgICAgcGhvbmVOdW1iZXI6IGVudHJ5LnBob25lTnVtYmVyLFxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICAvLyB1cGRhdGUgdGhlIGNhY2hlXG4gICAgcmVzb3VyY2VDYWNoZSA9IHJlc291cmNlTWFwO1xuICAgIHJlc291cmNlQ2FjaGVUaW1lc3RhbXAgPSBub3c7XG5cbiAgICByZXR1cm4gcmVzb3VyY2VNYXA7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihcIkVycm9yIGZldGNoaW5nIHJlc291cmNlIGxvY2F0aW9uIGRhdGE6XCIsIGVycm9yKTtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJGYWlsZWQgdG8gZmV0Y2ggcmVzb3VyY2UgbG9jYXRpb24gZGF0YVwiKTtcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0UmVzb3VyY2VMb2NhdGlvbkRldGFpbHMoXG4gIHJlc291cmNlTG9jYXRpb25JZDogbnVtYmVyXG4pOiBQcm9taXNlPFJlc291cmNlRW50cnkgfCBudWxsPiB7XG4gIHRyeSB7XG4gICAgY29uc3QgcmVzb3VyY2VNYXAgPSBhd2FpdCBmZXRjaFJlc291cmNlTG9jYXRpb24oKTtcbiAgICByZXR1cm4gcmVzb3VyY2VNYXAuZ2V0KHJlc291cmNlTG9jYXRpb25JZCkgfHwgbnVsbDtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgZmV0Y2hpbmcgcmVzb3VyY2UgbG9jYXRpb24gZGV0YWlsczpcIiwgZXJyb3IpO1xuICAgIHJldHVybiBudWxsO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZXIoXG4gIHJlcTogTmV4dEFwaVJlcXVlc3QsXG4gIHJlczogTmV4dEFwaVJlc3BvbnNlXG4pIHtcbiAgY29uc3QgeyByZXNvdXJjZUxvY2F0aW9uSWQgfSA9IHJlcS5xdWVyeTtcblxuICAvLyB2YWxpZGF0ZSBhbmQgcGFyc2UgbWFwSWRcbiAgaWYgKCFyZXNvdXJjZUxvY2F0aW9uSWQgfHwgQXJyYXkuaXNBcnJheShyZXNvdXJjZUxvY2F0aW9uSWQpKSB7XG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgZXJyb3I6IFwiSW52YWxpZCBvciBtaXNzaW5nIG1hcElkIHBhcmFtZXRlclwiIH0pO1xuICB9XG5cbiAgY29uc3QgcmVzb3VyY2VMb2NhdGlvbklkTnVtYmVyID0gTnVtYmVyKHJlc291cmNlTG9jYXRpb25JZCk7XG5cbiAgdHJ5IHtcbiAgICBjb25zb2xlLmxvZyhcInRoZSByZXNvdXJjZSBsb2NhdGlvbiBpZCBpczogXCIsIHJlc291cmNlTG9jYXRpb25JZClcbiAgICBjb25zdCBkYXRhID0gYXdhaXQgZ2V0UmVzb3VyY2VMb2NhdGlvbkRldGFpbHMocmVzb3VyY2VMb2NhdGlvbklkTnVtYmVyKTtcbiAgICBpZiAoIWRhdGEpIHtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuanNvbih7IGVycm9yOiBcIlJlc291cmNlIGxvY2F0aW9uIG5vdCBmb3VuZFwiIH0pO1xuICAgIH1cbiAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLmpzb24oZGF0YSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihcIkVycm9yIGluIGhhbmRsZXI6XCIsIGVycm9yKTtcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogXCJGYWlsZWQgdG8gZmV0Y2ggcmVzb3VyY2UgbG9jYXRpb24gZGF0YVwiIH0pO1xuICB9XG59XG4iXSwibmFtZXMiOlsicmVzb3VyY2VDYWNoZSIsInJlc291cmNlQ2FjaGVUaW1lc3RhbXAiLCJDQUNIRV9EVVJBVElPTiIsImZldGNoUmVzb3VyY2VMb2NhdGlvbiIsIm5vdyIsIkRhdGUiLCJ1cmwiLCJyZXNwIiwiZmV0Y2giLCJvayIsImVycm9yRGV0YWlscyIsInRleHQiLCJjb25zb2xlIiwiZXJyb3IiLCJzdGF0dXMiLCJFcnJvciIsImRhdGEiLCJqc29uIiwicmVzb3VyY2VNYXAiLCJNYXAiLCJmb3JFYWNoIiwiZW50cnkiLCJsb2NhbGl6ZWRFbnRyeSIsImxvY2FsaXplZFZhbHVlcyIsImZpbmQiLCJ2YWwiLCJjdWx0dXJlTmFtZSIsInNldCIsInJlc291cmNlTG9jYXRpb25JZCIsImZ1bGxOYW1lIiwiZGVzY3JpcHRpb24iLCJzdHJlZXRBZGRyZXNzIiwid2Vic2l0ZSIsImNpdHkiLCJyZWdpb24iLCJyZWdpb25Db2RlIiwiY291bnRyeSIsInBob25lTnVtYmVyIiwiZ2V0UmVzb3VyY2VMb2NhdGlvbkRldGFpbHMiLCJnZXQiLCJoYW5kbGVyIiwicmVxIiwicmVzIiwicXVlcnkiLCJBcnJheSIsImlzQXJyYXkiLCJyZXNvdXJjZUxvY2F0aW9uSWROdW1iZXIiLCJOdW1iZXIiLCJsb2ciXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./src/pages/api/ontario-parks/resource-details/getResourceDetails.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = (__webpack_exec__("(api)/./src/pages/api/ontario-parks/resource-details/getResourceDetails.ts"));
module.exports = __webpack_exports__;

})();